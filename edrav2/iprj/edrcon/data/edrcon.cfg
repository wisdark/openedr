{
	//
	// Default mode
	//
	"default": {

		//
		// Path to the data directory
		//
		"dataPath": {
			"$$proxy": "cachedCmd",
			"processor": "objects.application",
			"command": "getConfigValue",
			"params": {
				"default": "",
				"paths": [
					"app.config.extern.debug.dataPath",
					"app.defaultDataPath",
					"app.imagePath"
				]
			}
		},

		//
		// The definition of external configuration files
		//
		"extern": {

			//
			// Load endpoint.cfg (for edrcon it is always readonly)
			//
			"endpoint": {
				"$$proxy": "cachedCmd",
				"processor": "objects.application",
				"command": "loadObject",
				"params": {
					"path": {
						"$$proxy": "cachedCmd",
						"processor": { "clsid": "0x9FD7EEDA" }, // CLSID_VariantCmd
						"command": "add",
						"params": {
							"args": [
								{ "$gpath": "app.dataPath" },
								"\\endpoint.cfg"
							]
						}
					},
					"default": {}
				}
			},

			//
			// Load writable cloud config
			//
			"cloud": {
				"$$proxy": "cachedObj",
				"clsid": "0x54AFB9F0", // CLSID_DictionaryStreamView
				"stream": {
					"$$proxy": "cachedObj",
					"clsid": "0xCEFC4454", // CLSID_File
					"mode": "rwR",
					"path": {
						"$$proxy": "cachedCmd",
						"processor": { "clsid": "0x9FD7EEDA" }, // CLSID_VariantCmd
						"command": "add",
						"params": {
							"args": [
								{ "$gpath": "app.dataPath" },
								"\\cloud.cfg"
							]
						}
					}
				}
			},

			//
			// Load scenarios.cfg
			//
			"scenarios": {
				"$$proxy": "cachedCmd",
				"processor": "objects.application",
				"command": "loadObject",
				"params": {
					"path": [
						{
							"$$proxy": "cachedCmd",
							"processor": { "clsid": "0x9FD7EEDA" }, // CLSID_VariantCmd
							"command": "add",
							"params": {
								"args": [
									{ "$gpath": "app.dataPath" },
									"\\scenarios.cfg"
								]
							}
						},
						{
							"$$proxy": "cachedCmd",
							"processor": { "clsid": "0x9FD7EEDA" }, // CLSID_VariantCmd
							"command": "add",
							"params": {
								"args": [
									{ "$gpath": "app.imagePath" },
									"\\scenarios.cfg"
								]
							}
						}
					],
					"default": {}
				}
			},

			//
			// Load debug config
			//
			"debug": {
				"$$proxy": "cachedCmd",
				"processor": "objects.application",
				"command": "loadObject",
				"params": {
					"path": {
						"$$proxy": "cachedCmd",
						"processor": { "clsid": "0x9FD7EEDA" }, // CLSID_VariantCmd
						"command": "add",
						"params": {
							"args": [
								{ "$gpath": "app.configPath" },
								"\\debug.cfg"
							]
						}
					},
					"default": {}
				}
			}
		},

		//
		// Load TLS CA certificates bundle
		//
		"caCertificates": {
			"$$proxy": "cachedCmd",
			"processor": "objects.application",
			"command": "loadStreamAsString",
			"params": {
				"default": "",
				"stream": {
					"$$proxy": "cachedObj",
					"clsid": "0xCEFC4454", // CLSID_File
					"mode": "r",
					"path": {
						"$$proxy": "cachedCmd",
						"processor": { "clsid": "0x9FD7EEDA" }, // CLSID_VariantCmd
						"command": "add",
						"params": {
							"args": [
								{ "$gpath": "app.imagePath" },
								"\\cacert.pem"
							]
						}
					}
				}
			}
		},

		//
		// License settings
		//
		"license": {
			"token": {
				"$$proxy": "cmd",
				"processor": "objects.application",
				"command": "getConfigValue",
				"params": {
					"default": "",
					"paths": [
						"app.config.extern.debug.license.token",
						"app.config.extern.endpoint.license.token"
					]
				}
			},
			"machineId": {
				"$$proxy": "cmd",
				"processor": "objects.application",
				"command": "getConfigValue",
				"params": {
					"default": null,
					"paths": [
						"app.config.extern.debug.license.machineId",
						"app.config.extern.endpoint.license.machineId",
						"os.machineId"
					]
				}
			},
			"customerId": {
				"$$proxy": "cmd",
				"processor": "objects.application",
				"command": "getConfigValue",
				"params": {
					"default": "", // 881d5d5f-ad40-454e-b809-0b7188d22752
					"paths": [
						"app.config.extern.debug.license.customerId",
						"app.config.extern.endpoint.license.customerId"
					]
				}
			},
			"endpointId": {
				"$$proxy": "cmd",
				"processor": "objects.application",
				"command": "getConfigValue",
				"params": {
					"default": "", // bc55c2ee6eb9f12ca3944417bc3f1409
					"paths": [
						"app.config.extern.debug.license.endpointId",
						"app.config.extern.endpoint.license.endpointId"
					]
				}
			}
		},

		//
		// Cloud settings
		//
		"cloud": {

			"apiKey": "", //FIXME: REMOVED: apikey 

			"rootUrl": {
				"$$proxy": "cmd",
				"processor": "objects.application",
				"command": "getConfigValue",
				"params": {
					"default": "https://api.cwatchedr.com/endpoint", // For GCP
					"paths": [
						"app.config.extern.debug.cloud.rootUrl",
						"app.config.extern.endpoint.cloud.rootUrl"
					]
				}
			},

			"rootLegacyUrl": {
				"$$proxy": "cmd",
				"processor": "objects.application",
				"command": "getConfigValue",
				"params": {
					"default": "https://wtfibam2s5.execute-api.us-west-2.amazonaws.com/production/", // For AWS
					"paths": [
						"app.config.extern.debug.cloud.rootLegacyUrl",
						"app.config.extern.endpoint.cloud.rootLegacyUrl"
					]
				}
			},

			"gcp": {
				"pubSubTopic": {
					"$$proxy": "cmd",
					"processor": "objects.application",
					"command": "getConfigValue",
					"params": {
						"default": null,
						"paths": [
							"app.config.extern.debug.cloud.gcp.pubSubTopic",
							"app.config.extern.endpoint.cloud.gcp.pubSubTopic"
						]
					}
				},
				"saCredentials": {
					"$$proxy": "cmd",
					"processor": "objects.application",
					"command": "getConfigValue",
					"params": {
						"default": null,
						"paths": [
							"app.config.extern.debug.cloud.gcp.saCredentials",
							"app.config.extern.endpoint.cloud.gcp.saCredentials"
						]
					}
				},
				"caCertificates": {
					"$$proxy": "cmd",
					"processor": "objects.application",
					"command": "getConfigValue",
					"params": {
						"default": null,
						"paths": [ "app.config.caCertificates" ]
					}
				}
			},

			"aws": {
				"accessKey": {
					"$$proxy": "cmd",
					"processor": "objects.application",
					"command": "getConfigValue",
					"params": {
						"default": null, //FIXME: key removed
						"paths": [
							"app.config.extern.debug.cloud.aws.accessKey",
							"app.config.extern.endpoint.cloud.aws.accessKey"
						]
					}
				},
				"secretKey": {
					"$$proxy": "cmd",
					"processor": "objects.application",
					"command": "getConfigValue",
					"params": {
						"default": null, //FIXME: key removed
						"paths": [
							"app.config.extern.debug.cloud.aws.secretKey",
							"app.config.extern.endpoint.cloud.aws.secretKey"
						]
					}
				},
				"deliveryStream": {
					"$$proxy": "cmd",
					"processor": "objects.application",
					"command": "getConfigValue",
					"params": {
						"default": null, // "edr-evt-stream-development-central-v060"
						"paths": [
							"app.config.extern.debug.cloud.aws.deliveryStream",
							"app.config.extern.endpoint.cloud.aws.deliveryStream"
						]
					}
				}
			},
			"fls": {
				"url": {
					"$$proxy": "cmd",
					"processor": "objects.application",
					"command": "getConfigValue",
					"params": {
						"default": "fls.security.comodo.com",
						"paths": [
							"app.config.extern.debug.cloud.fls.url",
							"app.config.extern.endpoint.cloud.fls.url"
						]
					}
				}
			},
			"valkyrie": {
				"apiKey": {
					"$$proxy": "cmd",
					"processor": "objects.application",
					"command": "getConfigValue",
					"params": {
						"default": "75c810a9-1584-4a5b-bcbe-b4deeed521b5", //FIXME: key substituted
						"paths": [
							"app.config.extern.debug.cloud.valkyrie.apiKey",
							"app.config.extern.endpoint.cloud.valkyrie.apiKey"
						]
					}
				},
				"url": {
					"$$proxy": "cmd",
					"processor": "objects.application",
					"command": "getConfigValue",
					"params": {
						"default": "https://valkyrie.comodo.com", // https://staging.valkyrie.comodo.com
						"paths": [
							"app.config.extern.debug.cloud.valkyrie.url",
							"app.config.extern.endpoint.cloud.valkyrie.url"
						]
					}
				}
			}
		},

		//
		// Config serialization parameters
		//
		"serialization": {
			"format": "json",
			"encryption": {
				"$$proxy": "cachedCmd",
				"processor": "objects.application",
				"command": "getConfigValue",
				"params": {
					"default": "aes",
					"paths": "app.config.extern.debug.serialization.encryption"
				}
			},
			"compression": {
				"$$proxy": "cachedCmd",
				"processor": "objects.application",
				"command": "getConfigValue",
				"params": {
					"default": "",
					"paths": "app.config.extern.debug.serialization.compression"
				}
			}
		},

		//
		// Current policy settings
		//
		"policy": {
			"groups": {
				"patternsMatching": {
					"source": {
						"common": {
							"$$proxy": "cachedObj",
							"clsid": "0x54AFB9F0", // CLSID_DictionaryStreamView
							"readOnly": true,
							"stream": {
								"$$proxy": "cachedObj",
								"clsid": "0xCEFC4454", // CLSID_File
								"mode": "rR",
								"path": {
									"$$proxy": "cachedCmd",
									"processor": { "clsid": "0x9FD7EEDA" }, // CLSID_VariantCmd
									"command": "add",
									"params": {
										"args": [
											{ "$gpath": "app.imagePath" },
											"\\common.src"
										]
									}
								}
							},
							"default": {}
						},
						"ptmLocal": {
							"$$proxy": "cachedObj",
							"clsid": "0x54AFB9F0", // CLSID_DictionaryStreamView
							"readOnly": true,
							"stream": {
								"$$proxy": "cachedObj",
								"clsid": "0xCEFC4454", // CLSID_File
								"mode": "rR",
								"path": {
									"$$proxy": "cachedCmd",
									"processor": { "clsid": "0x9FD7EEDA" }, // CLSID_VariantCmd
									"command": "add",
									"params": {
										"args": [
											{ "$gpath": "app.imagePath" },
											"\\ptm.local.src"
										]
									}
								}
							},
							"default": {}
						},
						"ptmCloud": {
							"$$proxy": "cachedObj",
							"clsid": "0x54AFB9F0", // CLSID_DictionaryStreamView
							"stream": {
								"$$proxy": "cachedObj",
								"clsid": "0xCEFC4454", // CLSID_File
								"mode": "rwR",
								"path": {
									"$$proxy": "cachedCmd",
									"processor": { "clsid": "0x9FD7EEDA" }, // CLSID_VariantCmd
									"command": "add",
									"params": {
										"args": [
											{ "$gpath": "app.dataPath" },
											"\\ptm.cloud.src"
										]
									}
								}
							},
							"default": {}
						},
						"handlerPath": "app.config.extern.scenarios.qsc_match_patterns"
					},
					"active": {
						"$$proxy": "cachedObj",
						"clsid": "0x54AFB9F0", // CLSID_DictionaryStreamView
						"stream": {
							"$$proxy": "cachedObj",
							"clsid": "0xCEFC4454", // CLSID_File
							"mode": "rwR",
							"path": {
								"$$proxy": "cachedCmd",
								"processor": { "clsid": "0x9FD7EEDA" }, // CLSID_VariantCmd
								"command": "add",
								"params": {
									"args": [
										{ "$gpath": "app.dataPath" },
										"\\ptm.act"
									]
								}
							}
						},
						"default": {}
					},
					"scenario": {
						"$$proxy": "cachedCmd",
						"processor": "objects.application",
						"command": "getCatalogData",
						"params": {
							"path": "app.config.policy.groups.patternsMatching.active.scenario",
							"default": {
								"$$proxy": "cachedCmd",
								"clsid": "0x61A30254", // CLSID_Scenario
								"code": [
									{
										"clsid": "0x3C365C39", // CLSID_VariantCtxCmd
										"operation": "logwrn",
										"args": [ "The blank policy is used" ]
									},
									{
										"$ret": {
											"$val": {
												"$$proxy": "cachedObj",
												"clsid": "0x61A30254", // CLSID_Scenario
												"code": [
													{ "$ret": {} }
												]
											}
										}
									}
								]
							}
						}
					}
				},
				"eventsMatching": {
					"source": {
						"common": {
							"$$proxy": "cachedObj",
							"clsid": "0x54AFB9F0", // CLSID_DictionaryStreamView
							"readOnly": true,
							"stream": {
								"$$proxy": "cachedObj",
								"clsid": "0xCEFC4454", // CLSID_File
								"mode": "rR",
								"path": {
									"$$proxy": "cachedCmd",
									"processor": { "clsid": "0x9FD7EEDA" }, // CLSID_VariantCmd
									"command": "add",
									"params": {
										"args": [
											{ "$gpath": "app.imagePath" },
											"\\common.src"
										]
									}
								}
							},
							"default": {}
						},
						"evmCloud": {
							"$$proxy": "cachedObj",
							"clsid": "0x54AFB9F0", // CLSID_DictionaryStreamView
							"stream": {
								"$$proxy": "cachedObj",
								"clsid": "0xCEFC4454", // CLSID_File
								"mode": "rwR",
								"path": {
									"$$proxy": "cachedCmd",
									"processor": { "clsid": "0x9FD7EEDA" }, // CLSID_VariantCmd
									"command": "add",
									"params": {
										"args": [
											{ "$gpath": "app.dataPath" },
											"\\evm.cloud.src"
										]
									}
								}
							},
							"default": {}
						},
						"evmLocal": {
							"$$proxy": "cachedObj",
							"clsid": "0x54AFB9F0", // CLSID_DictionaryStreamView
							"readOnly": true,
							"stream": {
								"$$proxy": "cachedObj",
								"clsid": "0xCEFC4454", // CLSID_File
								"mode": "rR",
								"path": {
									"$$proxy": "cachedCmd",
									"processor": { "clsid": "0x9FD7EEDA" }, // CLSID_VariantCmd
									"command": "add",
									"params": {
										"args": [
											{ "$gpath": "app.imagePath" },
											"\\evm.local.src"
										]
									}
								}
							},
							"default": {}
						}
					},
					"active": {
						"$$proxy": "cachedObj",
						"clsid": "0x54AFB9F0", // CLSID_DictionaryStreamView
						"stream": {
							"$$proxy": "cachedObj",
							"clsid": "0xCEFC4454", // CLSID_File
							"mode": "rwR",
							"path": {
								"$$proxy": "cachedCmd",
								"processor": { "clsid": "0x9FD7EEDA" }, // CLSID_VariantCmd
								"command": "add",
								"params": {
									"args": [
										{ "$gpath": "app.dataPath" },
										"\\evm.act"
									]
								}
							}
						},
						"default": {}
					},
					"scenario": {
						"$$proxy": "cachedCmd",
						"processor": "objects.application",
						"command": "getCatalogData",
						"params": {
							"path": "app.config.policy.groups.eventsMatching.active.scenario",
							"default": {
								"$$proxy": "cachedCmd",
								"clsid": "0x61A30254", // CLSID_Scenario
								"code": [
									{
										"clsid": "0x3C365C39", // CLSID_VariantCtxCmd
										"operation": "logwrn",
										"args": [ "The blank policy is used" ]
									},
									{
										"$ret": {
											"$val": {
												"$$proxy": "cachedObj",
												"clsid": "0x61A30254", // CLSID_Scenario
												"code": [
													{ "$ret": {} }
												]
											}
										}
									}
								]
							}
						}
					},
					"handlerPath": "app.config.extern.scenarios.qsc_apply_policy"
				}
			},
			"verbose": {
				"$$proxy": "cachedCmd",
				"processor": "objects.application",
				"command": "getConfigValue",
				"params": {
					"default": false,
					"paths": "app.config.extern.debug.policy.verbose"
				}
			}
		},

		//
		// Logging settings
		//
		"log": {

			"logLevel": 3,
			"sink": [ "logfile" ],
			// Uncomment it for logging certain components
			//"components": {
			//  "comp1": { "logLevel": 1 },
			//  "comp2": { "logLevel": 2 }
			//},
			"sinks": {
				"console": {
					"$$clsid": "0xE18D3126", // CLSID_Log4CPlusSink
					"factory": "log4cplus::ConsoleAppender",
					"layout": {
						"factory": "log4cplus::PatternLayout",
						"ConversionPattern": "%t [%-8.-8c{1}] %m%n"
					}
				},
				"logfile": {
					"$$clsid": "0xE18D3126", // CLSID_Log4CPlusSink
					"factory": "log4cplus::SessionRollingFileAppender",
					"File": "edrcon-%U-%P.log",
					"FilenamePrefix": "edrcon",
					"Locale": "en_US.UTF8",
					"CreateDirs": true,
					"MaxSessionCount": 10,
					"MaxFileSize": "25MB",
					"MaxBackupIndex": 1,
					"layout": {
						"factory": "log4cplus::PatternLayout",
						"ConversionPattern": "%D{%Y%m%d-%H%M%S.%q} %t [%-8.-8c{1}] %m%n"
					}
				}
			}
		},

		//
		// Shared Objects and services
		//
		"objects": {
			//
			// Process Data Provider service settings
			//
			"processDataProvider": {
				"clsid": "0x92FA1819", // CLSID_ProcessDataProvider
				"purgeTimeout": {
					"$$proxy": "cachedCmd",
					"processor": "objects.application",
					"command": "getConfigValue",
					"params": {
						"default": 600000, // 10 min
						"paths": "app.config.extern.debug.processDataProvider.purgeTimeout"
					}
				},
				"purgeMask": {
					"$$proxy": "cachedCmd",
					"processor": "objects.application",
					"command": "getConfigValue",
					"params": {
						"default": 255, // 0xFF
						"paths": "app.config.extern.debug.processDataProvider.purgeMask"
					}
				}
			},

			//
			// File Data Provider service settings
			//
			"fileDataProvider": {
				"clsid": "0x2256416D" // CLSID_FileDataProvider
			},

			//
			// User Data Provider service settings
			//
			"userDataProvider": {
				"clsid": "0x7C249FE7" // CLSID_UserDataProvider
			},

			//
			// Signature Data Provider service settings
			//
			"signatureDataProvider": {
				"clsid": "0x2588A006" // CLSID_SignDataProvider
				//"disableNetworkAccess": true
			},

			//
			// Signature context settings
			//
			"contextService": {
				"clsid": "0x8548CCB3" // CLSID_ContextService
			},

			//
			// Path Converter service settings
			//
			"pathConverter": {
				"clsid": "0xB8901152" // CLSID_PathConverter
			},

			"cloudService": {
				"clsid": {
					"$$proxy": "cachedCmd",
					"processor": "objects.application",
					"command": "getConfigValue",
					"params": {
						"default": "0xD50330E1", // CLSID_CloudService
						"paths": [
							"app.config.extern.debug.cloud.provider"
						]
					}
				},
				"period": 90000,
				"networkUpdateMask": 1
			}
		},

		//
		// Message handlers
		//
		"messageHandlers": {
			"RequestPolicyUpdate": [
				{
					"info": "Compile EVM policy",
					"processor": {
						"clsid": "0x21C7DFD5", // CLSID_PolicyCompiler
						"config": {
							"$$proxy": "cachedCmd",
							"processor": "objects.application",
							"command": "loadObject",
							"params": {
								"path": {
									"$$proxy": "cachedCmd",
									"processor": { "clsid": "0x9FD7EEDA" }, // CLSID_VariantCmd
									"command": "add",
									"params": {
										"args": [
											{ "$gpath": "app.imagePath" },
											"\\compiler.cfg"
										]
									}
								},
								"default": {}
							}
						},
						"verbose": {
							"$$proxy": "cachedCmd",
							"processor": "objects.application",
							"command": "getConfigValue",
							"params": {
								"paths": "app.config.policy.verbose"
							}
						}
					},
					"command": "compile",
					"constParams": true,
					"params": {
						"group": "eventsMatching",
						"data": {
							"$$proxy": "cachedCmd",
							"processor": "objects.application",
							"command": "getConfigValue",
							"params": {
								"paths": "app.config.policy.groups.eventsMatching.source"
							}
						}
					}
				},
				{
					"info": "Compile PTM policy",
					"processor": {
						"clsid": "0x21C7DFD5", // CLSID_PolicyCompiler
						"config": {
							"$$proxy": "cachedCmd",
							"processor": "objects.application",
							"command": "loadObject",
							"params": {
								"path": {
									"$$proxy": "cachedCmd",
									"processor": { "clsid": "0x9FD7EEDA" }, // CLSID_VariantCmd
									"command": "add",
									"params": {
										"args": [
											{ "$gpath": "app.imagePath" },
											"\\compiler.cfg"
										]
									}
								},
								"default": {}
							}
						},
						"verbose": {
							"$$proxy": "cachedCmd",
							"processor": "objects.application",
							"command": "getConfigValue",
							"params": {
								"paths": "app.config.policy.verbose"
							}
						}
					},
					"command": "compile",
					"constParams": true,
					"params": {
						"group": "patternsMatching",
						"data": {
							"$$proxy": "cachedCmd",
							"processor": "objects.application",
							"command": "getConfigValue",
							"params": {
								"paths": "app.config.policy.groups.patternsMatching.source"
							}
						}
					}
				}
			],
			"PolicyIsUpdated": [
				{
					"info": "Update reload-pending scenarios",
					"processor": "objects.scenarioManager",
					"command": "updateScenarios"
				}
			],
			"RequestAppRestart": [
				{
					"info": "Edr service restart is requested",
					"processor": "objects.application",
					"command": "runInstance",
					"constParams": true,
					"params": { "args": "restart" }
				}
			]
		}
	},

	//
	// Debug mode
	//
	"debug": {
		"baseMode": "run",
		"log": {
			"logLevel": 0
		},
		"remote": {
			"port": 5889,
			"host": "127.0.0.1",
			"channelMode": {
				"$$proxy": "cachedCmd",
				"processor": "objects.application",
				"command": "getConfigValue",
				"params": {
					"default": "encrypted",
					"paths": "app.config.extern.debug.rpc.clientChannelMode"
				}
			},
			"encryption": "aes"
		}
	},

	//
	// Run scripts mode
	//
	"run": {
		"baseMode": "default",

		// Scenario scripts settings
		"script": {
			"filter_lle": {
				"type": 0, // Default LLE/MLE type for filtering (0 - no filtering)
				"pid": 2, // Default process PID for filtering (2 - no filtering)
				"outputQueue": "enrich_lle"
			},
			"enrich_lle": {
				"outputQueue": "apply_policy"
			},
			"get_fls_verdict": {
				"trustedVendorList": {
					"$$proxy": "cachedCmd",
					"processor": "objects.application",
					"command": "getConfigValue",
					"params": {
						"default": [
							"Microsoft",
							"Microsoft Anti-Virus Publisher",
							"Microsoft BV",
							"Microsoft Consumer Windows Publisher",
							"Microsoft Corp.",
							"Microsoft Corporation",
							"Microsoft Corporation(Europe)",
							"Microsoft Corporation(For Internal Use Only)",
							"Microsoft Corporation(Internal Use Only)",
							"Microsoft Corporation MSN",
							"Microsoft Corporation MSN(Europe)",
							"Microsoft Digital Media Code Signing",
							"Microsoft DRM Publisher",
							"Microsoft Dynamic Code Publisher",
							"Microsoft Fusion Verification",
							"Microsoft Great Plains Business Solutions",
							"Microsoft LIVE Gaming for Windows",
							"Microsoft LIVE Gaming on Windows",
							"Microsoft Mobile Device Privileged Component Update Publisher",
							"Microsoft Mobile Device Privileged Publisher",
							"Microsoft Mobile Device TCB Publisher",
							"Microsoft Mobile Device Unprivileged Component Update Publisher",
							"Microsoft Mobile Device Unprivileged Publisher",
							"Microsoft Mobile Device VSD Publisher",
							"Microsoft Mobile Software Privileged Execution Publisher",
							"Microsoft Open Technologies Inc",
							"Microsoft Time-Stamp Service",
							"Microsoft TimeStamping Service",
							"Microsoft Windows",
							"Microsoft Windows 2000 Publisher",
							"Microsoft Windows 2000 Publisher(Europe)",
							"Microsoft Windows 3rd party Component",
							"Microsoft Windows CE Cryptographic Service Provider Signature",
							"Microsoft Windows Component Publisher",
							"Microsoft Windows Early Launch Anti-malware Publisher",
							"Microsoft Windows Hardware Compatibility Publisher",
							"Microsoft Windows Home Entertainment Software Publisher",
							"Microsoft Windows Publisher",
							"Microsoft Windows Third Party Application Component",
							"Microsoft Windows XP Publisher",
							"Comodo",
							"comodo",
							"Comodo - Customer Support - Chennai",
							"Comodo - Customer Support - NJ",
							"Comodo CA Limited",
							"COMODO CA LimiTed",
							"Comodo CA Ltd",
							"Comodo CP, Inc",
							"Comodo Group Inc.",
							"Comodo Inc.",
							"Comodo Security Solutions",
							"Comodo Security Solutions, Inc",
							"Comodo Security Solutions, Inc.",
							"Comodo Support",
							"COMODO Time Stamping Signer",
							"Comodo Time Stamping Signer",
							"Mountain Security LTD"
						],
						"paths": "app.config.extern.debug.trustedVendorList"
					}
				}
			},
			"apply_policy": {
				"outputQueue": "enrich_mle",
				"enableDiscardedLog": {
					"$$proxy": "cachedCmd",
					"processor": "objects.application",
					"command": "getConfigValue",
					"params": {
						"default": false,
						"paths": "app.config.extern.debug.enableDiscardedLog"
					}
				},
				"discardedLog": {
					"$$proxy": "cachedObj",
					"clsid": "0xCEFC4454", // CLSID_File
					"useSimplePut": true,
					"path": {
						"$$proxy": "cachedCmd",
						"processor": { "clsid": "0x9FD7EEDA" }, // CLSID_VariantCmd
						"command": "add",
						"params": {
							"args": [
								{ "$gpath": "app.logPath" },
								"\\discarded_events.log"
							]
						}
					},
					"putDelimiter": "\n\n",
					"mode": "wtRW"
				},
				"lleRecieverCmd": {
					"$$proxy": "cmd",
					"processor": "objects.application",
					"command": "getConfigValue",
					"params": {
						"default": null,
						"paths": "app.config.extern.debug.lleRecieverCmd"
					}
				}
			},
			"enrich_mle": {
				"outputQueue": "check_for_valkyrie"
			},
			"check_for_valkyrie": {
				"outputQueue": "transform_for_cloud",
				"submitQueue": "submit_to_valkyrie",
				"enableCache": {
					"$$proxy": "cachedCmd",
					"processor": "objects.application",
					"command": "getConfigValue",
					"params": {
						"default": true,
						"paths": "app.config.extern.debug.valkyrieCheck.enableCache"
					}
				},
				// Cache for files which has been already checked
				// and forwarded to submission to Valkyrie
				"cache": {
					"$$proxy": "cachedObj",
					"clsid": "0x404B416C" // CLSID_StringCache
				},
				"flsVerdict": {
					"$$proxy": "cachedCmd",
					"processor": "objects.application",
					"command": "getConfigValue",
					"params": {
						"default": 0, // Absent
						"paths": "app.config.extern.debug.valkyrieCheck.flsVerdict"
					}
				}
			},
			"submit_to_valkyrie": {
				"retryCount": 3,
				// delay on failed submit in milliseconds
				// TODO: Too complex 2-level config... need optimization
				"retryDelay": {
					"$$proxy": "cachedCmd",
					"processor": "objects.application",
					"command": "getConfigValue",
					"params": {
						"default": 10000,
						"paths": "app.config.extern.debug.valkyrieSubmit.retryDelay"
					}
				},
				// Support replacement of submit command for ATS
				"submitCmd": {
					"$$proxy": "cachedCmd",
					"processor": "objects.application",
					"command": "getConfigValue",
					"params": {
						"default": null,
						"paths": "app.config.extern.debug.valkyrieSubmit.submitCmd"
					}
				}
			},
			"transform_for_cloud": {
				"outputQueue": "output"
			},
			"output": {
				"enableMainReceiver": {
					"$$proxy": "cachedCmd",
					"processor": "objects.application",
					"command": "getConfigValue",
					"params": {
						"default": false,
						"paths": "app.config.extern.debug.enableMainReceiver"
					}
				},
				"mainReceiver": {
					"$$proxy": "cachedCmd",
					"clsid": "0x61A30254", // CLSID_Scenario
					"code": [
						{
							"$if": {
								"$gpath": "app.config.extern.debug.useGcpReceiver",
								"$default": false
							},
							"$ret": {
								"$val": {
									"$$proxy": "cachedObj",
									"clsid": "0x51C1CAB6", // CLSID_GcpPubSubClient
									"saCredentials": {
										"$$proxy": "cachedCmd",
										"processor": "objects.application",
										"command": "getCatalogData",
										"params": { "path": "app.config.cloud.gcp.saCredentials" }
									},
									"pubSubTopic": {
										"$$proxy": "cachedCmd",
										"processor": "objects.application",
										"command": "getCatalogData",
										"params": { "path": "app.config.cloud.gcp.pubSubTopic" }
									},
									"caCertificates": {
										"$$proxy": "cachedCmd",
										"processor": "objects.application",
										"command": "getCatalogData",
										"params": { "path": "app.config.cloud.gcp.caCertificates" }
									}
								}
							}
						},
						{
							"$ret": {
								"$val": {
									"$$proxy": "cachedObj",
									"clsid": "0x95BA0E24", // CLSID_AwsFirehoseClient
									"accessKey": {
										"$$proxy": "cachedCmd",
										"processor": "objects.application",
										"command": "getCatalogData",
										"params": { "path": "app.config.cloud.aws.accessKey" }
									},
									"secretKey": {
										"$$proxy": "cachedCmd",
										"processor": "objects.application",
										"command": "getCatalogData",
										"params": { "path": "app.config.cloud.aws.secretKey" }
									},
									"deliveryStream": {
										"$$proxy": "cachedCmd",
										"processor": "objects.application",
										"command": "getCatalogData",
										"params": { "path": "app.config.cloud.aws.deliveryStream" }
									}
								}
							}
						}
					]
				},
				// Delay between two failed submission attemps (in milliseconds)
				"mainReceiverRetryDelay": {
					"$$proxy": "cachedCmd",
					"processor": "objects.application",
					"command": "getConfigValue",
					"params": {
						"default": 10000,
						"paths": "app.config.extern.debug.mainReceiverRetryDelay"
					}
				},
				// Batch output mode
				"enableMainReceiverBatchMode": {
					"$$proxy": "cachedCmd",
					"processor": "objects.application",
					"command": "getConfigValue",
					"params": {
						"default": false,
						"paths": "app.config.extern.debug.enableMainReceiverBatchMode"
					}
				},
				"batchQueue": "output_batch",

				"enableLogReceiver": false,
				"logReceiver": {
					"$$proxy": "cachedObj",
					"clsid": "0xCEFC4454", // CLSID_File
					"path": {
						"$$proxy": "cachedCmd",
						"processor": { "clsid": "0x9FD7EEDA" }, // CLSID_VariantCmd
						"command": "add",
						"params": {
							"args": [
								{ "$gpath": "app.logPath" },
								"\\output_events.log"
							]
						}
					},
					"putDelimiter": "\n\n",
					"mode": "wtRW"
				},
				"enableDirReceiver": {
					"$$proxy": "cachedCmd",
					"processor": "objects.application",
					"command": "getConfigValue",
					"params": {
						"default": false,
						"paths": "app.config.extern.debug.enableDirReceiver"
					}
				},
				"dirReceiver": {
					"$$proxy": "cachedObj",
					"clsid": "0xDA024E57", // CLSID_FsDataStorage
					"deleteOnGet": false,
					"mode": "create|truncate",
					"prettyOutput": true,
					"path": {
						"$$proxy": "cachedCmd",
						"processor": { "clsid": "0x9FD7EEDA" }, // CLSID_VariantCmd
						"command": "add",
						"params": {
							"args": [
								{ "$gpath": "app.logPath" },
								"\\output_events"
							]
						}
					}
				}
			}
		},

		"objects": {

			"queueManager": {
				"clsid": "0x9E88430D", // CLSID_QueueManager
				"autoStart": true,
				// Queues configuration
				"queues": {

					"input": {
						"maxSize": 10000,
						"tag": "input",
						"notifyAcceptor": {
							"$$proxy": "cachedCmd",
							"processor": "objects.application",
							"command": "getCatalogData",
							"params": {
								"path": "objects.eventEnricher"
							}
						}
					},

					"inbox": {
						"maxSize": 10000
					},

					"filter_lle": {
						"maxSize": 10000,
						"tag": "qsc_filter_lle",
						"notifyAcceptor": {
							"$$proxy": "cachedCmd",
							"processor": "objects.application",
							"command": "getCatalogData",
							"params": {
								"path": "objects.scenarioManager"
							}
						}
					},

					"enrich_lle": {
						"maxSize": 10000,
						"tag": "qsc_enrich_lle",
						"notifyAcceptor": {
							"$$proxy": "cachedCmd",
							"processor": "objects.application",
							"command": "getCatalogData",
							"params": {
								"path": "objects.scenarioManager"
							}
						}
					},

					"get_fls_verdict": {
						"maxSize": 10000,
						"tag": "qsc_get_fls_verdict",
						"notifyAcceptor": {
							"$$proxy": "cachedCmd",
							"processor": "objects.application",
							"command": "getCatalogData",
							"params": {
								"path": "objects.scenarioManager"
							}
						}
					},

					"apply_policy": {
						"maxSize": 10000,
						"tag": "qsc_apply_policy",
						"notifyAcceptor": {
							"$$proxy": "cachedCmd",
							"processor": "objects.application",
							"command": "getCatalogData",
							"params": {
								"path": "objects.scenarioManager"
							}
						}
					},

					"enrich_mle": {
						"maxSize": 10000,
						"tag": "qsc_enrich_mle",
						"notifyAcceptor": {
							"$$proxy": "cachedCmd",
							"processor": "objects.application",
							"command": "getCatalogData",
							"params": {
								"path": "objects.scenarioManager"
							}
						}
					},

					"calc_file_hash": {
						"maxSize": 10000,
						"tag": "qsc_calc_file_hash",
						"notifyAcceptor": {
							"$$proxy": "cachedCmd",
							"processor": "objects.application",
							"command": "getCatalogData",
							"params": {
								"path": "objects.scenarioManager"
							}
						}
					},

					"check_for_valkyrie": {
						"maxSize": 10000,
						"tag": "qsc_check_for_valkyrie",
						"notifyAcceptor": {
							"$$proxy": "cachedCmd",
							"processor": "objects.application",
							"command": "getCatalogData",
							"params": {
								"path": "objects.scenarioManager"
							}
						}
					},

					"submit_to_valkyrie": {
						"maxSize": 10000,
						"tag": "qsc_submit_to_valkyrie",
						"notifyAcceptor": {
							"$$proxy": "cachedCmd",
							"processor": "objects.application",
							"command": "getCatalogData",
							"params": {
								"path": "objects.scenarioManager"
							}
						}
					},

					"transform_for_cloud": {
						"maxSize": 10000,
						"tag": "qsc_transform_for_cloud",
						"notifyAcceptor": {
							"$$proxy": "cachedCmd",
							"processor": "objects.application",
							"command": "getCatalogData",
							"params": {
								"path": "objects.scenarioManager"
							}
						}
					},

					//
					// Events in queue are outputed to the destination receivers
					//
					"output": {
						"maxSize": 10000,
						"tag": "qsc_output",
						"notifyAcceptor": {
							"$$proxy": "cachedCmd",
							"processor": "objects.application",
							"command": "getCatalogData",
							"params": {
								"path": "objects.scenarioManager"
							}
						}
					},

					//
					// Queue with out events groupped into batches
					//
					"output_batch": {
						"maxSize": 10000,
						"tag": "qsc_output_batch",
						"batchSize": 100,
						"batchTimeout": 5000,
						"notifyAcceptor": {
							"$$proxy": "cachedCmd",
							"processor": "objects.application",
							"command": "getCatalogData",
							"params": {
								"path": "objects.scenarioManager"
							}
						}
					}
				}
			},

			"scenarioManager": {
				"clsid": "0xB15D1291", // CLSID_ScenarioManager
				"threadPools": {
					"DefaultPool": { "size": 2 }, // count of workring threads in default pool
					"SlowPool": { "size": 2 }, // Pool for slow operations: hash calc, etc.
					"OutputPool": { "size": 1 }, // Pool for output. It contains sleep() calling
					"ValkyriePool": { "size": 1 }, // It should be in separate pool as contains sleep() calling
					"ApplyPolicyPool": { "size": 2 } // Check if we need pool for it
				}
			},

			//
			// System monitor controller settings
			//
			"systemMonitorController": {
				"clsid": "0x5A601182", // CLSID_SystemMonitorController
				"receiver": {
					"$$proxy": "cachedObj",
					"clsid": "0xDE854411", // CLSID_QueueProxy
					"name": "input"
				},
				"threadsCount": 2, // TODO: We can decrease it to 1 after tests and events optimization
				"stopDriverOnShutdown": true,

				"injectNewProcesses": {
					"$$proxy": "cachedCmd",
					"processor": "objects.application",
					"command": "getConfigValue",
					"params": {
						"default": 1, // 0 - disable, 1 - driver, 2 - service
						"paths": "app.config.extern.debug.systemMonitorController.injectNewProcesses"
					}
				},

				// Sysmon driver configuration
				"driverConfig": {
					"$$proxy": "cachedCmd",
					"processor": "objects.application",
					"command": "getConfigValue",
					"params": {
						"mergeMode": 11, // All + mergeNestedDict
						"default": {
							"disableSelfProtection": true, // Disable self protection
							"openProcessRepeatTimeout": 10000, // Timeout between sending the same openProcess events
							"regEventRepeatTimeout": 10000, // Timeout between sending the same RegCreateKey & RegSetValueevents
							"verifyInjectedDll": false, // Disable signature verification
							"eventFlags": 4294966655 // Disable sending FileOpen (7) & FileClose (9)
						},
						"paths": "app.config.extern.debug.edrdrv"
					}
				},

				// Selfprotection configuration
				"selfprotectConfig": {}
			},

			//
			// Events enricher service settings
			//
			"eventEnricher": {
				"clsid": "0x9E4CE9E1", // CLSID_EventEnricher
				"receiver": {
					"$$proxy": "cachedObj",
					"clsid": "0xDE854411", // CLSID_QueueProxy
					"name": "inbox"
				},
				"formats": {
					"EXECUTABLE": ".exe;.dll;.sys"
				}
			},

			//
			//
			//
			"flsService": {
				"clsid": "0xE6404215", // CLSID_FlsService
				"url": {
					"$$proxy": "cachedCmd",
					"processor": "objects.application",
					"command": "getConfigValue",
					"params": {
						"paths": "app.config.cloud.fls.url"
					}
				},
				"verdictCache": [
					{
						"verdict": 0, // Absent
						"purgeTimeout": 7200 // 2 hours
					},
					{
						"verdict": 1, // Safe
						"purgeTimeout": 172800 // 2 days
					},
					{
						"verdict": 2, // Malicious
						"purgeTimeout": 172800 // 2 days
					},
					{
						"verdict": 3, // Unknown
						"purgeTimeout": 7200 // 2 hours
					}
				]
				// "statePath": "app.config.state.flsService.data"
			},

			"valkyrieService": {
				"clsid": "0x2B758353", // CLSID_ValkyrieService
				//"statePath": "app.config.state.valkyrieService.data",
				"apiKey": {
					"$$proxy": "cachedCmd",
					"processor": "objects.application",
					"command": "getConfigValue",
					"params": {
						"paths": "app.config.cloud.valkyrie.apiKey"
					}
				},
				"url": {
					"$$proxy": "cachedCmd",
					"processor": "objects.application",
					"command": "getConfigValue",
					"params": {
						"paths": "app.config.cloud.valkyrie.url"
					}
				},
				"endpointId": {
					"$$proxy": "cachedCmd",
					"processor": "objects.application",
					"command": "getConfigValue",
					"params": {
						"paths": "app.config.license.endpointId"
					}
				}
			}
		},

		"messageHandlers": {
			"AppStarted": [
				{
					"info": "Starting Scenarios Manager",
					"command": "start",
					"constParams": true,
					"processor": "objects.scenarioManager"
				},
				{
					"info": "Starting FLS Service",
					"command": "start",
					"constParams": true,
					"processor": "objects.flsService"
				},
				{
					"info": "Starting Valkyrie Service",
					"command": "start",
					"constParams": true,
					"processor": "objects.valkyrieService",
					"params": {}
				},
				{
					"info": "Starting Process Data Provider",
					"processor": "objects.processDataProvider",
					"command": "start",
					"constParams": true,
					"params": {}
				},
				{
					"info": "Starting User Data Provider",
					"processor": "objects.userDataProvider",
					"command": "start",
					"constParams": true,
					"params": {}
				},
				{
					"info": "Starting Signature Data Provider",
					"processor": "objects.signatureDataProvider",
					"command": "start",
					"constParams": true,
					"params": {}
				},
				{
					"info": "Starting File Data Provider",
					"processor": "objects.fileDataProvider",
					"command": "start",
					"constParams": true,
					"params": {}
				},
				{
					"info": "Starting Event Enricher",
					"processor": "objects.eventEnricher",
					"command": "start",
					"constParams": true,
					"params": {}
				},
				{
					"info": "Starting Signature Context",
					"processor": "objects.contextService",
					"command": "start",
					"constParams": true,
					"params": {}
				}
			],
			"AppFinishing": [
				{
					"info": "Stopping User Data Provider",
					"processor": "objects.userDataProvider",
					"command": "stop",
					"constParams": true,
					"params": {}
				},
				{
					"info": "Stopping Signature Data Provider",
					"processor": "objects.signatureDataProvider",
					"command": "stop",
					"constParams": true,
					"params": {}
				},
				{
					"info": "Stopping File Data Provider",
					"processor": "objects.fileDataProvider",
					"command": "stop",
					"constParams": true,
					"params": {}
				},
				{
					"info": "Stopping Process Data Provider",
					"command": "stop",
					"constParams": true,
					"processor": "objects.processDataProvider"
				},
				{
					"info": "Stopping Event Enricher",
					"processor": "objects.eventEnricher",
					"command": "stop",
					"constParams": true,
					"params": {}
				},
				{
					"info": "Stopping Signature Context",
					"processor": "objects.contextService",
					"command": "stop",
					"constParams": true,
					"params": {}
				},
				{
					"info": "Stopping FLS Service",
					"command": "stop",
					"constParams": true,
					"processor": "objects.flsService"
				},
				{
					"info": "Stopping Valkyrie Service",
					"command": "stop",
					"constParams": true,
					"processor": "objects.valkyrieService",
					"params": {}
				},
				{
					"info": "Stopping Scenarios Manager",
					"command": "stop",
					"constParams": true,
					"processor": "objects.scenarioManager"
				}
			]
		}
	},

	//
	//
	//
	"unprot": {
		"baseMode": "default",
		"objects": {

			// Service RPC client
			"svcControlRpcClient": {
				"clsid": "0x694C9C8E", // CLSID_JsonRpcClient
				"host": "127.0.0.1",
				"timeout": 30,
				"port": 5889,
				"channelMode": {
					"$$proxy": "cachedCmd",
					"processor": "objects.application",
					"command": "getConfigValue",
					"params": {
						"default": "encrypted",
						"paths": "app.config.extern.debug.rpc.clientChannelMode"
					}
				},
				"encryption": "aes",
				"verbose": {
					"$$proxy": "cachedCmd",
					"processor": "objects.application",
					"command": "getConfigValue",
					"params": {
						"default": false,
						"paths": "app.config.extern.debug.rpc.clientVerbose"
					}
				}
			},

			// Driver controller
			"systemMonitorController": {
				"clsid": "0x5A601182" // CLSID_SystemMonitorController
			}
		}
	},

	//
	//
	//
	"process": {
		"baseMode": "default",
		"objects": {
			"processMonitorController": {
				"clsid": "0xC0A1AD0B" // CLSID_ProcessMonitorController
			}
		}
	},

	//
	//
	//
	"rpcserver": {
		"baseMode": "default",
		"server": {
			"$$clsid": "0xDAA32B15", // CLSID_JsonRpcServer
			"port": 9999,
			"processor": {
				"clsid": "0x694C9C8E", // CLSID_JsonRpcClient
				"host": "127.0.0.1",
				"port": 9998,
				"timeout": 120
			}
		}
	}
}
